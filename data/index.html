<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>PSI3541 - Sistemas Embarcados Distribuídos (2025)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="https://www.espressif.com/sites/all/themes/espressif/favicon.ico" type="image/vnd.microsoft.icon">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css"
        crossorigin="anonymous">
</head>

<body>
    <header>
        <h1>PSI3541 - Sistemas Embarcados Distribuídos (2025)</h1>
        <h3>Aluno: Pedro Alves Munhoz - 11257053</h3>
    </header>

    <div class="main-flex">
        <!-- Configuração do Controle PD (esquerda) -->
        <div class="card slim-card" id="car-config-menu">
            <h4>Controle PD</h4>
            <div class="config-fields">
                <div>
                    <label for="kp-value">Kp</label>
                    <input type="number" id="kp-value" step="0.01" min="0" class="input-slim">
                </div>
                <div>
                    <label for="kp-total-value">Kp_total</label>
                    <input type="number" id="kp-total-value" step="0.01" min="0" class="input-slim">
                </div>
                <div>
                    <label for="kd-value">Kd</label>
                    <input type="number" id="kd-value" step="0.01" min="0" class="input-slim">
                </div>
                <div>
                    <label for="ki-value">Ki</label>
                    <input type="number" id="ki-value" step="0.01" min="0" class="input-slim">
                </div>
                <button class="button button-green" id="send-config-btn">
                    Enviar
                </button>
                <div id="config-status" class="status-text"></div>
            </div>
        </div>

        <!-- Car Move Menu Card (centro) -->
        <div class="card main-card" id="car-move-menu">
            <h4>Movimentar Carrinho</h4>
            <div style="display: flex; flex-direction: column; align-items: center; gap: 12px;">
                <div>
                    <button class="button car-move-menu-btn" data-state="0" data-label="Frente">
                        <i class="fas fa-arrow-up"></i> Frente
                    </button>
                </div>
                <div>
                    <button class="button car-move-menu-btn" data-state="1" data-label="Trás">
                        <i class="fas fa-arrow-down"></i> Trás
                    </button>
                </div>
                <div>
                    <button class="button car-move-menu-btn" data-state="2" data-label="Esquerda">
                        <i class="fas fa-arrow-left"></i> Esquerda
                    </button>
                    <button class="button car-move-menu-btn" data-state="3" data-label="Direita">
                        <i class="fas fa-arrow-right"></i> Direita
                    </button>
                </div>
                <div>
                    <button class="button car-move-menu-btn" data-state="4" data-label="Rotacionar Esquerda">
                        <i class="fas fa-undo"></i> Rotacionar Esquerda
                    </button>
                    <button class="button car-move-menu-btn" data-state="5" data-label="Rotacionar Direita">
                        <i class="fas fa-redo"></i> Rotacionar Direita
                    </button>
                </div>
                <div style="margin-top:10px;">
                    <label for="ref-value">Referência</label>
                    <input type="number" id="ref-value" value="50" min="1" step="0.01" class="input-slim" style="width:60px;">
                    <span id="ref-unit">cm</span>
                </div>
                <button class="button button-green" id="send-move-btn" style="margin-top:8px;">
                    Enviar Comando
                </button>
            </div>
            <div id="move-status" class="status-text"></div>
        </div>

        <!-- Status do Carrinho (direita) -->
        <div class="card slim-card" id="car-status-menu">
            <h4>Status</h4>
            <div id="car-status-content" class="status-content">
                Carregando status...
                <div style="margin-top:12px;">
                    <div id="progress-bar-container" style="background:#e0e0e0; border-radius:8px; height:18px; width:100%; max-width:220px; margin:0 auto; overflow:hidden;">
                        <div id="progress-bar" style="background:#008c3a; height:100%; width:0%; transition:width 0.3s;"></div>
                    </div>
                    <div id="progress-text" style="font-size:0.95em; margin-top:4px; color:#333;"></div>
                </div>
                <canvas id="car-canvas" width="180" height="80" style="margin-top:12px; display:block; margin-left:auto; margin-right:auto;"></canvas>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="card full-width" id="mqtt-tasks-card">
            <h3>MQTT Publish Tasks</h3>
            <table id="mqtt-tasks-table" style="width:100%; text-align:center;">
                <thead>
                    <tr>
                        <th>Task</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Rows will be filled by JS -->
                </tbody>
            </table>
        </div>
    </div>

    <script src="main.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js" type="application/javascript"></script>
</body>
</html>